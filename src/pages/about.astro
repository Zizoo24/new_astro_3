---
import BaseLayout from '../layouts/BaseLayout.astro';
import DulBadge from '../components/DulBadge.astro';
import AuthorityLogos from '../components/AuthorityLogos.astro';
import { getEntry } from 'astro:content';

type IntroWithImage = {
  type: 'introWithImage';
  heading: string;
  p1: string;
  p2?: string;
  features: { label: string; text: string }[];
  image: string;
  imageAlt: string;
};

type Licensing = {
  type: 'licensing';
  sectionLabel: string;
  sectionTitle: string;
  mojLabel: string;
  mojTitle: string;
  mojSubtitle: string;
  note: string;
};

type AuthorityLogosSection = {
  type: 'authorityLogos';
  title: string;
};

type ValuesSection = {
  type: 'values';
  sectionLabel: string;
  sectionTitle: string;
  items: { title: string; text: string }[];
};

type CtaSection = {
  type: 'cta';
  heading: string;
  body: string;
  buttonLabel: string;
  buttonUrl: string;
};

type MissionSection = {
  type: 'mission';
  sectionLabel: string;
  sectionTitle: string;
  statement: string;
  vision?: string;
};

type LanguagesSection = {
  type: 'languages';
  sectionLabel: string;
  sectionTitle: string;
  intro: string;
  languages: { name: string; pairs: string[] }[];
};

type HistorySection = {
  type: 'history';
  sectionLabel: string;
  sectionTitle: string;
  timeline: { year: string; title: string; description: string }[];
};

type Section =
  | IntroWithImage
  | Licensing
  | AuthorityLogosSection
  | ValuesSection
  | CtaSection
  | MissionSection
  | LanguagesSection
  | HistorySection;

const aboutEntry = await getEntry('core', 'about');
const data = aboutEntry?.data as {
  pageTitle: string;
  metaDescription: string;
  heroHeading: string;
  heroSubheading?: string;
  heroLead?: string;
  sections?: Section[];
};

const pageTitle = data.pageTitle;
const metaDescription = data.metaDescription;
const heroHeading = data.heroHeading;
const heroSubheading = data.heroSubheading ?? '';
const heroLead = data.heroLead ?? '';
const sections: Section[] = data.sections ?? [];
---
<BaseLayout
  title={pageTitle}
  description={metaDescription}
>
  <section class="page-hero about-hero">
    <div class="hero-background">
      <img src="/assets/images/onedrive/hero/office-team.png" alt="OnlineTranslation.ae professional team" loading="eager" />
      <div class="hero-overlay"></div>
    </div>
    <div class="container">
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <a href="/">Home</a>
        <span class="separator">&gt;</span>
        <span class="current">About</span>
      </nav>
      <h1 class="page-title">{heroHeading}</h1>
      {heroSubheading && <p class="page-subtitle">{heroSubheading}</p>}
      {heroLead && <p class="page-lead">{heroLead}</p>}
    </div>
  </section>

  {sections.map((section) => {
    if (section.type === 'introWithImage') {
      const s = section as IntroWithImage;
      return (
        <section class="section about-intro">
          <div class="container">
            <div class="about-content-grid">
              <div class="about-text">
                <h2>{s.heading}</h2>
                <p>{s.p1}</p>
                {s.p2 && <p>{s.p2}</p>}

                <p>Our service model is built around two core promises:</p>

                <ul class="about-features">
                  {s.features.map((f) => (
                    <li>
                      <strong>{f.label}:</strong> {f.text}
                    </li>
                  ))}
                </ul>
              </div>

              <div class="about-image">
                <img
                  src={s.image}
                  alt={s.imageAlt}
                  loading="lazy"
                />
              </div>
            </div>
          </div>
        </section>
      );
    }

    if (section.type === 'licensing') {
      const s = section as Licensing;
      return (
        <section class="section licensing-section">
          <div class="container">
            <div class="section-header">
              <span class="section-label">{s.sectionLabel}</span>
              <h2 class="section-title">{s.sectionTitle}</h2>
            </div>

            <div class="licensing-grid">
              <div class="licensing-card">
                <DulBadge variant="detailed" />
              </div>

              <div class="licensing-card moj-card">
                <div class="moj-badge-icon">
                  <svg
                    width="32"
                    height="32"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="1.5"
                  >
                    <path d="M12 2L2 7l10 5 10-5-10-5z" />
                    <path d="M2 17l10 5 10-5" />
                    <path d="M2 12l10 5 10-5" />
                  </svg>
                </div>
                <div class="moj-badge-content">
                  <span class="moj-badge-label">{s.mojLabel}</span>
                  <span class="moj-badge-title">{s.mojTitle}</span>
                  <span class="moj-badge-subtitle">{s.mojSubtitle}</span>
                </div>
              </div>
            </div>

            <div class="compliance-note">
              <p>{s.note}</p>
            </div>
          </div>
        </section>
      );
    }

    if (section.type === 'authorityLogos') {
      const s = section as AuthorityLogosSection;
      return (
        <section class="section authority-section">
          <div class="container">
            <AuthorityLogos title={s.title} />
          </div>
        </section>
      );
    }

    if (section.type === 'values') {
      const s = section as ValuesSection;
      return (
        <section class="section values-section">
          <div class="container">
            <div class="section-header">
              <span class="section-label">{s.sectionLabel}</span>
              <h2 class="section-title">{s.sectionTitle}</h2>
            </div>

            <div class="values-grid">
              {s.items.map((item) => (
                <article class="value-card">
                  <div class="value-icon">
                    {/* keep existing SVG icons, or use one shared icon */}
                    <svg
                      width="28"
                      height="28"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <circle cx="12" cy="12" r="10" />
                      <polyline points="12 6 12 12 16 14" />
                    </svg>
                  </div>
                  <h3>{item.title}</h3>
                  <p>{item.text}</p>
                </article>
              ))}
            </div>
          </div>
        </section>
      );
    }

    if (section.type === 'cta') {
      const s = section as CtaSection;
      return (
        <section class="section cta-section">
          <div class="container">
            <div class="cta-card">
              <h2>{s.heading}</h2>
              <p>{s.body}</p>
              <a href={s.buttonUrl} class="cta-button">
                <i class="fab fa-whatsapp"></i> {s.buttonLabel}
              </a>
            </div>
          </div>
        </section>
      );
    }

    if (section.type === 'mission') {
      const s = section as MissionSection;
      return (
        <section class="section mission-section">
          <div class="container">
            <div class="section-header">
              <span class="section-label">{s.sectionLabel}</span>
              <h2 class="section-title">{s.sectionTitle}</h2>
            </div>
            <div class="mission-content">
              <blockquote class="mission-statement">
                <p>{s.statement}</p>
              </blockquote>
              {s.vision && (
                <div class="vision-statement">
                  <h3>Our Vision</h3>
                  <p>{s.vision}</p>
                </div>
              )}
            </div>
          </div>
        </section>
      );
    }

    if (section.type === 'languages') {
      const s = section as LanguagesSection;
      return (
        <section class="section languages-section">
          <div class="container">
            <div class="section-header">
              <span class="section-label">{s.sectionLabel}</span>
              <h2 class="section-title">{s.sectionTitle}</h2>
            </div>
            <p class="languages-intro">{s.intro}</p>
            <div class="languages-grid">
              {s.languages.map((lang) => (
                <div class="language-card">
                  <h3>{lang.name}</h3>
                  <ul>
                    {lang.pairs.map((pair) => (
                      <li>{pair}</li>
                    ))}
                  </ul>
                </div>
              ))}
            </div>
          </div>
        </section>
      );
    }

    if (section.type === 'history') {
      const s = section as HistorySection;
      return (
        <section class="section history-section">
          <div class="container">
            <div class="section-header">
              <span class="section-label">{s.sectionLabel}</span>
              <h2 class="section-title">{s.sectionTitle}</h2>
            </div>
            <div class="timeline">
              {s.timeline.map((item, index) => (
                <div class="timeline-item">
                  <div class="timeline-marker">
                    <span class="timeline-year">{item.year}</span>
                  </div>
                  <div class="timeline-content">
                    <h3>{item.title}</h3>
                    <p>{item.description}</p>
                  </div>
                </div>
              ))}
            </div>
          </div>
        </section>
      );
    }

    return null;
  })}
</BaseLayout>

<style>
  .about-hero {
    background: linear-gradient(135deg, var(--primary-navy, #0E2B48) 0%, #1a3a5c 100%);
    padding: 3rem 0 2rem;
    position: relative;
  }

  .about-hero .page-title {
    color: #ffffff;
    font-size: clamp(1.8rem, 4vw, 2.5rem);
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 0.5rem;
  }

  .about-hero .page-subtitle {
    color: var(--accent-coral, #FF1654);
    font-size: 1.1rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.1em;
  }

  .about-intro {
    padding: 3rem 0;
  }

  .about-content-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
    align-items: center;
  }

  .about-text h2 {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--primary-navy, #0E2B48);
    margin-bottom: 1rem;
  }

  .about-text p {
    color: var(--text-muted, #5a6a7a);
    line-height: 1.8;
    margin-bottom: 1rem;
  }

  .about-features {
    list-style: none;
    padding: 0;
    margin: 1.5rem 0;
  }

  .about-features li {
    padding: 0.75rem 0;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    color: var(--text-dark, #1a1a1a);
  }

  .about-features li strong {
    color: var(--accent-coral, #FF1654);
  }

  .about-image img {
    width: 100%;
    border-radius: 1rem;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
  }

  .licensing-section {
    background: var(--bg-light, #f8f9fa);
    padding: 3rem 0;
  }

  .licensing-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  .licensing-card {
    background: #ffffff;
    border-radius: 1rem;
    padding: 1.5rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
  }

  .moj-card {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .moj-badge-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 3.5rem;
    height: 3.5rem;
    background: linear-gradient(135deg, var(--primary-navy, #0E2B48) 0%, #1a3a5c 100%);
    border-radius: 0.75rem;
    color: white;
    flex-shrink: 0;
  }

  .moj-badge-content {
    display: flex;
    flex-direction: column;
    gap: 0.15rem;
  }

  .moj-badge-label {
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--accent-coral, #FF1654);
  }

  .moj-badge-title {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--text-dark, #1a1a1a);
  }

  .moj-badge-subtitle {
    font-size: 0.85rem;
    color: var(--text-muted, #5a6a7a);
  }

  .compliance-note {
    background: rgba(14, 43, 72, 0.05);
    border-left: 4px solid var(--primary-navy, #0E2B48);
    padding: 1rem 1.5rem;
    border-radius: 0 0.5rem 0.5rem 0;
  }

  .compliance-note p {
    margin: 0;
    color: var(--text-dark, #1a1a1a);
    font-size: 0.95rem;
    line-height: 1.7;
  }

  .values-section {
    padding: 3rem 0;
  }

  .values-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1.5rem;
  }

  .value-card {
    background: #ffffff;
    border-radius: 1rem;
    padding: 1.5rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
    transition: all 0.3s ease;
  }

  .value-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
  }

  .value-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 3rem;
    height: 3rem;
    background: linear-gradient(135deg, var(--accent-coral, #FF1654) 0%, #e81447 100%);
    border-radius: 0.75rem;
    color: white;
    margin-bottom: 1rem;
  }

  .value-card h3 {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--primary-navy, #0E2B48);
    margin-bottom: 0.5rem;
  }

  .value-card p {
    font-size: 0.9rem;
    color: var(--text-muted, #5a6a7a);
    line-height: 1.7;
  }

  .cta-section {
    padding: 3rem 0;
    background: linear-gradient(135deg, var(--primary-navy, #0E2B48) 0%, #1a3a5c 100%);
  }

  .cta-card {
    text-align: center;
    max-width: 600px;
    margin: 0 auto;
  }

  .cta-card h2 {
    color: #ffffff;
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 1rem;
  }

  .cta-card p {
    color: rgba(255, 255, 255, 0.85);
    font-size: 1.05rem;
    line-height: 1.7;
    margin-bottom: 1.5rem;
  }

  .cta-button {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem 2rem;
    background: var(--accent-coral, #FF1654);
    color: white;
    font-size: 1rem;
    font-weight: 600;
    text-decoration: none;
    border-radius: 0.5rem;
    transition: all 0.3s ease;
  }

  .cta-button:hover {
    background: #e81447;
    transform: translateY(-2px);
  }

  @media (max-width: 768px) {
    .about-content-grid {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .about-image {
      order: -1;
    }

    .licensing-grid {
      grid-template-columns: 1fr;
    }

    .values-grid {
      grid-template-columns: 1fr;
    }

    .moj-card {
      flex-direction: column;
      text-align: center;
    }
  }

  /* Dark mode */
  :global(body.theme-dark) .about-text h2 {
    color: #f0f6fc;
  }

  :global(body.theme-dark) .about-text p {
    color: #a8b3c2;
  }

  :global(body.theme-dark) .about-features li {
    color: #e6edf3;
    border-color: rgba(255, 255, 255, 0.1);
  }

  :global(body.theme-dark) .licensing-section {
    background: #161b22;
  }

  :global(body.theme-dark) .licensing-card {
    background: #21262d;
  }

  :global(body.theme-dark) .moj-badge-title {
    color: #f0f6fc;
  }

  :global(body.theme-dark) .moj-badge-subtitle {
    color: #a8b3c2;
  }

  :global(body.theme-dark) .compliance-note {
    background: rgba(255, 255, 255, 0.05);
  }

  :global(body.theme-dark) .compliance-note p {
    color: #e6edf3;
  }

  :global(body.theme-dark) .value-card {
    background: #21262d;
  }

  :global(body.theme-dark) .value-card h3 {
    color: #f0f6fc;
  }

  :global(body.theme-dark) .value-card p {
    color: #a8b3c2;
  }

  /* Mission Section */
  .mission-section {
    background: var(--bg-light, #f8f9fa);
    padding: 3rem 0;
  }

  .mission-content {
    max-width: 800px;
    margin: 0 auto;
    text-align: center;
  }

  .mission-statement {
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--primary-navy, #0E2B48);
    line-height: 1.6;
    margin: 0;
    padding: 2rem;
    background: #ffffff;
    border-radius: 1rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
    border-left: 4px solid var(--accent-coral, #FF1654);
  }

  .mission-statement p {
    margin: 0;
  }

  .vision-statement {
    margin-top: 2rem;
    padding: 1.5rem;
    background: rgba(14, 43, 72, 0.05);
    border-radius: 0.75rem;
  }

  .vision-statement h3 {
    font-size: 1rem;
    font-weight: 700;
    color: var(--accent-coral, #FF1654);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-bottom: 0.5rem;
  }

  .vision-statement p {
    margin: 0;
    color: var(--text-dark, #1a1a1a);
    font-size: 1.1rem;
  }

  /* Languages Section */
  .languages-section {
    padding: 3rem 0;
  }

  .languages-intro {
    text-align: center;
    max-width: 700px;
    margin: 0 auto 2rem;
    color: var(--text-muted, #5a6a7a);
    font-size: 1.05rem;
    line-height: 1.7;
  }

  .languages-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1.5rem;
  }

  .language-card {
    background: #ffffff;
    border-radius: 1rem;
    padding: 1.5rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
    text-align: center;
  }

  .language-card h3 {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--primary-navy, #0E2B48);
    margin-bottom: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 2px solid var(--accent-coral, #FF1654);
  }

  .language-card ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .language-card li {
    font-size: 0.9rem;
    color: var(--text-muted, #5a6a7a);
    padding: 0.5rem 0;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
  }

  .language-card li:last-child {
    border-bottom: none;
  }

  /* History Section */
  .history-section {
    background: var(--bg-light, #f8f9fa);
    padding: 3rem 0;
  }

  .timeline {
    max-width: 700px;
    margin: 0 auto;
    position: relative;
  }

  .timeline::before {
    content: '';
    position: absolute;
    left: 50px;
    top: 0;
    bottom: 0;
    width: 2px;
    background: var(--accent-coral, #FF1654);
  }

  .timeline-item {
    display: flex;
    gap: 2rem;
    margin-bottom: 2rem;
  }

  .timeline-marker {
    flex-shrink: 0;
    width: 100px;
    text-align: center;
  }

  .timeline-year {
    display: inline-block;
    padding: 0.5rem 1rem;
    background: var(--primary-navy, #0E2B48);
    color: #ffffff;
    font-size: 0.9rem;
    font-weight: 700;
    border-radius: 2rem;
  }

  .timeline-content {
    flex: 1;
    background: #ffffff;
    padding: 1.5rem;
    border-radius: 0.75rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
  }

  .timeline-content h3 {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--primary-navy, #0E2B48);
    margin-bottom: 0.5rem;
  }

  .timeline-content p {
    font-size: 0.95rem;
    color: var(--text-muted, #5a6a7a);
    line-height: 1.6;
    margin: 0;
  }

  @media (max-width: 992px) {
    .languages-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 768px) {
    .languages-grid {
      grid-template-columns: 1fr;
    }

    .mission-statement {
      font-size: 1.2rem;
      padding: 1.5rem;
    }

    .timeline::before {
      left: 20px;
    }

    .timeline-marker {
      width: 60px;
    }

    .timeline-year {
      font-size: 0.8rem;
      padding: 0.4rem 0.75rem;
    }
  }

  /* Dark mode for new sections */
  :global(body.theme-dark) .mission-section {
    background: #161b22;
  }

  :global(body.theme-dark) .mission-statement {
    background: #21262d;
    color: #f0f6fc;
  }

  :global(body.theme-dark) .vision-statement {
    background: rgba(255, 255, 255, 0.05);
  }

  :global(body.theme-dark) .vision-statement p {
    color: #e6edf3;
  }

  :global(body.theme-dark) .languages-intro {
    color: #a8b3c2;
  }

  :global(body.theme-dark) .language-card {
    background: #21262d;
  }

  :global(body.theme-dark) .language-card h3 {
    color: #f0f6fc;
  }

  :global(body.theme-dark) .language-card li {
    color: #a8b3c2;
    border-color: rgba(255, 255, 255, 0.1);
  }

  :global(body.theme-dark) .history-section {
    background: #161b22;
  }

  :global(body.theme-dark) .timeline-content {
    background: #21262d;
  }

  :global(body.theme-dark) .timeline-content h3 {
    color: #f0f6fc;
  }

  :global(body.theme-dark) .timeline-content p {
    color: #a8b3c2;
  }
</style>
